# Задание 2: Аспектно-ориентированное программирование в Spring

## Структура проекта

```
src/main/java/
└── ru.diasoft.springbootcourse
    ├── App.java                      # Главный класс приложения
    ├── controller/
    │   └── DoublingController.java   # REST-контроллер с методами /doubling и /test
    ├── service/
    │   ├── DoublingService.java      # Интерфейс сервиса с методами getDoubling и getTest
    │   └── DoublingServiceImpl.java  # Реализация сервиса, выполняющая удвоение и демонстрирующая логирование
    ├── domain/
    │   └── Doubling.java             # Объект для передачи результата операции удвоения
    └── aspect/
        ├── annotation/
        │   └── Loggable.java         # Кастомная аннотация для логгирования методов
        └── LoggingAspect.java        # AOP-аспект для логгирования вызовов методов
```

---

## Реализация

### Аннотация

- `@Loggable` используется для пометки методов, выполнение которых должно логироваться аспектом.

### Аспект

- `LoggingAspect` перехватывает вызовы методов, помеченных `@Loggable`.
- Логирует:
  - название метода,
  - входные параметры,
  - результат выполнения,
  - ошибку (если произошла).

### Контроллер

- `DoublingController`:
  - эндпоинт `/doubling` — выполняет удвоение числа (логика из задания 1),
  - эндпоинт `/test` — вызывает метод `getTest()`, помеченный `@Loggable`, для демонстрации работы аспекта.

### Сервис

- **Интерфейс `DoublingService`**:
  - метод `getDoubling(Integer value)` возвращает объект `Doubling`,
  - метод `getTest()` используется для проверки работы аннотации.
- **Реализация `DoublingServiceImpl`**:
  - выполняет удвоение числа и формирует DTO,
  - метод `getTest()` помечен аннотацией `@Loggable`, чтобы продемонстрировать работу AOP.

### Объект `Doubling`

- Поля объекта:
  - `id` — уникальный идентификатор запроса,
  - `doublingValue` — удвоенное число,
  - `message` — текстовое описание результата.
- Используется для передачи данных от сервиса к контроллеру и в JSON-ответе API.

---

## Пример запросов и ответов

1. Запрос с числом:

```
GET /doubling?number=7
```

Ответ (JSON):

```json
{
  "id": 1,
  "doublingValue": 14,
  "message": "Удвоенное значение: 14"
}
```

2. Запрос без параметра:

```
GET /doubling
```

Ответ (JSON):

```json
{
  "id": 2,
  "doublingValue": 0,
  "message": "Удвоенное значение: 0"
}
```

3. Запрос к тестовому методу:

```
GET /test
```

Ответ:

```
Тест логгирования
```

4. Пример логов при вызове /test:

```
INFO  — Вызов метода: getTest
INFO  — Входные параметры: []
INFO  — Результат: Тест логгирования
INFO  — Завершение метода: getTest
```

5. Если в методе произойдёт ошибка:

```
ERROR — java.lang.RuntimeException: <сообщение>
```